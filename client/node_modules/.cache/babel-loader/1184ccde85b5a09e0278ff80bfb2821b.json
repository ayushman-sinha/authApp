{"ast":null,"code":"import { CompactEncrypt } from '../jwe/compact/encrypt.js';\nimport { encoder } from '../lib/buffer_utils.js';\nimport { ProduceJWT } from './produce.js';\nexport class EncryptJWT extends ProduceJWT {\n  setProtectedHeader(protectedHeader) {\n    if (this._protectedHeader) {\n      throw new TypeError('setProtectedHeader can only be called once');\n    }\n\n    this._protectedHeader = protectedHeader;\n    return this;\n  }\n\n  setKeyManagementParameters(parameters) {\n    if (this._keyManagementParameters) {\n      throw new TypeError('setKeyManagementParameters can only be called once');\n    }\n\n    this._keyManagementParameters = parameters;\n    return this;\n  }\n\n  setContentEncryptionKey(cek) {\n    if (this._cek) {\n      throw new TypeError('setContentEncryptionKey can only be called once');\n    }\n\n    this._cek = cek;\n    return this;\n  }\n\n  setInitializationVector(iv) {\n    if (this._iv) {\n      throw new TypeError('setInitializationVector can only be called once');\n    }\n\n    this._iv = iv;\n    return this;\n  }\n\n  replicateIssuerAsHeader() {\n    this._replicateIssuerAsHeader = true;\n    return this;\n  }\n\n  replicateSubjectAsHeader() {\n    this._replicateSubjectAsHeader = true;\n    return this;\n  }\n\n  replicateAudienceAsHeader() {\n    this._replicateAudienceAsHeader = true;\n    return this;\n  }\n\n  async encrypt(key, options) {\n    const enc = new CompactEncrypt(encoder.encode(JSON.stringify(this._payload)));\n\n    if (this._replicateIssuerAsHeader) {\n      this._protectedHeader = { ...this._protectedHeader,\n        iss: this._payload.iss\n      };\n    }\n\n    if (this._replicateSubjectAsHeader) {\n      this._protectedHeader = { ...this._protectedHeader,\n        sub: this._payload.sub\n      };\n    }\n\n    if (this._replicateAudienceAsHeader) {\n      this._protectedHeader = { ...this._protectedHeader,\n        aud: this._payload.aud\n      };\n    }\n\n    enc.setProtectedHeader(this._protectedHeader);\n\n    if (this._iv) {\n      enc.setInitializationVector(this._iv);\n    }\n\n    if (this._cek) {\n      enc.setContentEncryptionKey(this._cek);\n    }\n\n    if (this._keyManagementParameters) {\n      enc.setKeyManagementParameters(this._keyManagementParameters);\n    }\n\n    return enc.encrypt(key, options);\n  }\n\n}","map":{"version":3,"names":["CompactEncrypt","encoder","ProduceJWT","EncryptJWT","setProtectedHeader","protectedHeader","_protectedHeader","TypeError","setKeyManagementParameters","parameters","_keyManagementParameters","setContentEncryptionKey","cek","_cek","setInitializationVector","iv","_iv","replicateIssuerAsHeader","_replicateIssuerAsHeader","replicateSubjectAsHeader","_replicateSubjectAsHeader","replicateAudienceAsHeader","_replicateAudienceAsHeader","encrypt","key","options","enc","encode","JSON","stringify","_payload","iss","sub","aud"],"sources":["D:/React/authApp/client/node_modules/jose/dist/browser/jwt/encrypt.js"],"sourcesContent":["import { CompactEncrypt } from '../jwe/compact/encrypt.js';\nimport { encoder } from '../lib/buffer_utils.js';\nimport { ProduceJWT } from './produce.js';\nexport class EncryptJWT extends ProduceJWT {\n    setProtectedHeader(protectedHeader) {\n        if (this._protectedHeader) {\n            throw new TypeError('setProtectedHeader can only be called once');\n        }\n        this._protectedHeader = protectedHeader;\n        return this;\n    }\n    setKeyManagementParameters(parameters) {\n        if (this._keyManagementParameters) {\n            throw new TypeError('setKeyManagementParameters can only be called once');\n        }\n        this._keyManagementParameters = parameters;\n        return this;\n    }\n    setContentEncryptionKey(cek) {\n        if (this._cek) {\n            throw new TypeError('setContentEncryptionKey can only be called once');\n        }\n        this._cek = cek;\n        return this;\n    }\n    setInitializationVector(iv) {\n        if (this._iv) {\n            throw new TypeError('setInitializationVector can only be called once');\n        }\n        this._iv = iv;\n        return this;\n    }\n    replicateIssuerAsHeader() {\n        this._replicateIssuerAsHeader = true;\n        return this;\n    }\n    replicateSubjectAsHeader() {\n        this._replicateSubjectAsHeader = true;\n        return this;\n    }\n    replicateAudienceAsHeader() {\n        this._replicateAudienceAsHeader = true;\n        return this;\n    }\n    async encrypt(key, options) {\n        const enc = new CompactEncrypt(encoder.encode(JSON.stringify(this._payload)));\n        if (this._replicateIssuerAsHeader) {\n            this._protectedHeader = { ...this._protectedHeader, iss: this._payload.iss };\n        }\n        if (this._replicateSubjectAsHeader) {\n            this._protectedHeader = { ...this._protectedHeader, sub: this._payload.sub };\n        }\n        if (this._replicateAudienceAsHeader) {\n            this._protectedHeader = { ...this._protectedHeader, aud: this._payload.aud };\n        }\n        enc.setProtectedHeader(this._protectedHeader);\n        if (this._iv) {\n            enc.setInitializationVector(this._iv);\n        }\n        if (this._cek) {\n            enc.setContentEncryptionKey(this._cek);\n        }\n        if (this._keyManagementParameters) {\n            enc.setKeyManagementParameters(this._keyManagementParameters);\n        }\n        return enc.encrypt(key, options);\n    }\n}\n"],"mappings":"AAAA,SAASA,cAAT,QAA+B,2BAA/B;AACA,SAASC,OAAT,QAAwB,wBAAxB;AACA,SAASC,UAAT,QAA2B,cAA3B;AACA,OAAO,MAAMC,UAAN,SAAyBD,UAAzB,CAAoC;EACvCE,kBAAkB,CAACC,eAAD,EAAkB;IAChC,IAAI,KAAKC,gBAAT,EAA2B;MACvB,MAAM,IAAIC,SAAJ,CAAc,4CAAd,CAAN;IACH;;IACD,KAAKD,gBAAL,GAAwBD,eAAxB;IACA,OAAO,IAAP;EACH;;EACDG,0BAA0B,CAACC,UAAD,EAAa;IACnC,IAAI,KAAKC,wBAAT,EAAmC;MAC/B,MAAM,IAAIH,SAAJ,CAAc,oDAAd,CAAN;IACH;;IACD,KAAKG,wBAAL,GAAgCD,UAAhC;IACA,OAAO,IAAP;EACH;;EACDE,uBAAuB,CAACC,GAAD,EAAM;IACzB,IAAI,KAAKC,IAAT,EAAe;MACX,MAAM,IAAIN,SAAJ,CAAc,iDAAd,CAAN;IACH;;IACD,KAAKM,IAAL,GAAYD,GAAZ;IACA,OAAO,IAAP;EACH;;EACDE,uBAAuB,CAACC,EAAD,EAAK;IACxB,IAAI,KAAKC,GAAT,EAAc;MACV,MAAM,IAAIT,SAAJ,CAAc,iDAAd,CAAN;IACH;;IACD,KAAKS,GAAL,GAAWD,EAAX;IACA,OAAO,IAAP;EACH;;EACDE,uBAAuB,GAAG;IACtB,KAAKC,wBAAL,GAAgC,IAAhC;IACA,OAAO,IAAP;EACH;;EACDC,wBAAwB,GAAG;IACvB,KAAKC,yBAAL,GAAiC,IAAjC;IACA,OAAO,IAAP;EACH;;EACDC,yBAAyB,GAAG;IACxB,KAAKC,0BAAL,GAAkC,IAAlC;IACA,OAAO,IAAP;EACH;;EACY,MAAPC,OAAO,CAACC,GAAD,EAAMC,OAAN,EAAe;IACxB,MAAMC,GAAG,GAAG,IAAI1B,cAAJ,CAAmBC,OAAO,CAAC0B,MAAR,CAAeC,IAAI,CAACC,SAAL,CAAe,KAAKC,QAApB,CAAf,CAAnB,CAAZ;;IACA,IAAI,KAAKZ,wBAAT,EAAmC;MAC/B,KAAKZ,gBAAL,GAAwB,EAAE,GAAG,KAAKA,gBAAV;QAA4ByB,GAAG,EAAE,KAAKD,QAAL,CAAcC;MAA/C,CAAxB;IACH;;IACD,IAAI,KAAKX,yBAAT,EAAoC;MAChC,KAAKd,gBAAL,GAAwB,EAAE,GAAG,KAAKA,gBAAV;QAA4B0B,GAAG,EAAE,KAAKF,QAAL,CAAcE;MAA/C,CAAxB;IACH;;IACD,IAAI,KAAKV,0BAAT,EAAqC;MACjC,KAAKhB,gBAAL,GAAwB,EAAE,GAAG,KAAKA,gBAAV;QAA4B2B,GAAG,EAAE,KAAKH,QAAL,CAAcG;MAA/C,CAAxB;IACH;;IACDP,GAAG,CAACtB,kBAAJ,CAAuB,KAAKE,gBAA5B;;IACA,IAAI,KAAKU,GAAT,EAAc;MACVU,GAAG,CAACZ,uBAAJ,CAA4B,KAAKE,GAAjC;IACH;;IACD,IAAI,KAAKH,IAAT,EAAe;MACXa,GAAG,CAACf,uBAAJ,CAA4B,KAAKE,IAAjC;IACH;;IACD,IAAI,KAAKH,wBAAT,EAAmC;MAC/BgB,GAAG,CAAClB,0BAAJ,CAA+B,KAAKE,wBAApC;IACH;;IACD,OAAOgB,GAAG,CAACH,OAAJ,CAAYC,GAAZ,EAAiBC,OAAjB,CAAP;EACH;;AA/DsC"},"metadata":{},"sourceType":"module"}