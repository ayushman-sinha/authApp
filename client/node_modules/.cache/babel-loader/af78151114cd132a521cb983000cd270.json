{"ast":null,"code":"import { isCloudflareWorkers, isNodeJs } from './env.js';\nimport crypto from './webcrypto.js';\nimport { JOSENotSupported } from '../util/errors.js';\nimport { decode as base64url } from './base64url.js';\n\nfunction subtleMapping(jwk) {\n  let algorithm;\n  let keyUsages;\n\n  switch (jwk.kty) {\n    case 'oct':\n      {\n        switch (jwk.alg) {\n          case 'HS256':\n          case 'HS384':\n          case 'HS512':\n            algorithm = {\n              name: 'HMAC',\n              hash: `SHA-${jwk.alg.slice(-3)}`\n            };\n            keyUsages = ['sign', 'verify'];\n            break;\n\n          case 'A128CBC-HS256':\n          case 'A192CBC-HS384':\n          case 'A256CBC-HS512':\n            throw new JOSENotSupported(`${jwk.alg} keys cannot be imported as CryptoKey instances`);\n\n          case 'A128GCM':\n          case 'A192GCM':\n          case 'A256GCM':\n          case 'A128GCMKW':\n          case 'A192GCMKW':\n          case 'A256GCMKW':\n            algorithm = {\n              name: 'AES-GCM'\n            };\n            keyUsages = ['encrypt', 'decrypt'];\n            break;\n\n          case 'A128KW':\n          case 'A192KW':\n          case 'A256KW':\n            algorithm = {\n              name: 'AES-KW'\n            };\n            keyUsages = ['wrapKey', 'unwrapKey'];\n            break;\n\n          case 'PBES2-HS256+A128KW':\n          case 'PBES2-HS384+A192KW':\n          case 'PBES2-HS512+A256KW':\n            algorithm = {\n              name: 'PBKDF2'\n            };\n            keyUsages = ['deriveBits'];\n            break;\n\n          default:\n            throw new JOSENotSupported('Invalid or unsupported JWK \"alg\" (Algorithm) Parameter value');\n        }\n\n        break;\n      }\n\n    case 'RSA':\n      {\n        switch (jwk.alg) {\n          case 'PS256':\n          case 'PS384':\n          case 'PS512':\n            algorithm = {\n              name: 'RSA-PSS',\n              hash: `SHA-${jwk.alg.slice(-3)}`\n            };\n            keyUsages = jwk.d ? ['sign'] : ['verify'];\n            break;\n\n          case 'RS256':\n          case 'RS384':\n          case 'RS512':\n            algorithm = {\n              name: 'RSASSA-PKCS1-v1_5',\n              hash: `SHA-${jwk.alg.slice(-3)}`\n            };\n            keyUsages = jwk.d ? ['sign'] : ['verify'];\n            break;\n\n          case 'RSA-OAEP':\n          case 'RSA-OAEP-256':\n          case 'RSA-OAEP-384':\n          case 'RSA-OAEP-512':\n            algorithm = {\n              name: 'RSA-OAEP',\n              hash: `SHA-${parseInt(jwk.alg.slice(-3), 10) || 1}`\n            };\n            keyUsages = jwk.d ? ['decrypt', 'unwrapKey'] : ['encrypt', 'wrapKey'];\n            break;\n\n          default:\n            throw new JOSENotSupported('Invalid or unsupported JWK \"alg\" (Algorithm) Parameter value');\n        }\n\n        break;\n      }\n\n    case 'EC':\n      {\n        switch (jwk.alg) {\n          case 'ES256':\n            algorithm = {\n              name: 'ECDSA',\n              namedCurve: 'P-256'\n            };\n            keyUsages = jwk.d ? ['sign'] : ['verify'];\n            break;\n\n          case 'ES384':\n            algorithm = {\n              name: 'ECDSA',\n              namedCurve: 'P-384'\n            };\n            keyUsages = jwk.d ? ['sign'] : ['verify'];\n            break;\n\n          case 'ES512':\n            algorithm = {\n              name: 'ECDSA',\n              namedCurve: 'P-521'\n            };\n            keyUsages = jwk.d ? ['sign'] : ['verify'];\n            break;\n\n          case 'ECDH-ES':\n          case 'ECDH-ES+A128KW':\n          case 'ECDH-ES+A192KW':\n          case 'ECDH-ES+A256KW':\n            algorithm = {\n              name: 'ECDH',\n              namedCurve: jwk.crv\n            };\n            keyUsages = jwk.d ? ['deriveBits'] : [];\n            break;\n\n          default:\n            throw new JOSENotSupported('Invalid or unsupported JWK \"alg\" (Algorithm) Parameter value');\n        }\n\n        break;\n      }\n\n    case (isCloudflareWorkers() || isNodeJs()) && 'OKP':\n      if (jwk.alg !== 'EdDSA') {\n        throw new JOSENotSupported('Invalid or unsupported JWK \"alg\" (Algorithm) Parameter value');\n      }\n\n      switch (jwk.crv) {\n        case 'Ed25519':\n          algorithm = {\n            name: 'NODE-ED25519',\n            namedCurve: 'NODE-ED25519'\n          };\n          keyUsages = jwk.d ? ['sign'] : ['verify'];\n          break;\n\n        case isNodeJs() && 'Ed448':\n          algorithm = {\n            name: 'NODE-ED448',\n            namedCurve: 'NODE-ED448'\n          };\n          keyUsages = jwk.d ? ['sign'] : ['verify'];\n          break;\n\n        default:\n          throw new JOSENotSupported('Invalid or unsupported JWK \"crv\" (Subtype of Key Pair) Parameter value');\n      }\n\n      break;\n\n    default:\n      throw new JOSENotSupported('Invalid or unsupported JWK \"kty\" (Key Type) Parameter value');\n  }\n\n  return {\n    algorithm,\n    keyUsages\n  };\n}\n\nconst parse = async jwk => {\n  var _a, _b;\n\n  const {\n    algorithm,\n    keyUsages\n  } = subtleMapping(jwk);\n  const rest = [algorithm, (_a = jwk.ext) !== null && _a !== void 0 ? _a : false, (_b = jwk.key_ops) !== null && _b !== void 0 ? _b : keyUsages];\n\n  if (algorithm.name === 'PBKDF2') {\n    return crypto.subtle.importKey('raw', base64url(jwk.k), ...rest);\n  }\n\n  const keyData = { ...jwk\n  };\n  delete keyData.alg;\n  return crypto.subtle.importKey('jwk', keyData, ...rest);\n};\n\nexport default parse;","map":{"version":3,"names":["isCloudflareWorkers","isNodeJs","crypto","JOSENotSupported","decode","base64url","subtleMapping","jwk","algorithm","keyUsages","kty","alg","name","hash","slice","d","parseInt","namedCurve","crv","parse","_a","_b","rest","ext","key_ops","subtle","importKey","k","keyData"],"sources":["D:/React/authApp/client/node_modules/jose/dist/browser/runtime/jwk_to_key.js"],"sourcesContent":["import { isCloudflareWorkers, isNodeJs } from './env.js';\nimport crypto from './webcrypto.js';\nimport { JOSENotSupported } from '../util/errors.js';\nimport { decode as base64url } from './base64url.js';\nfunction subtleMapping(jwk) {\n    let algorithm;\n    let keyUsages;\n    switch (jwk.kty) {\n        case 'oct': {\n            switch (jwk.alg) {\n                case 'HS256':\n                case 'HS384':\n                case 'HS512':\n                    algorithm = { name: 'HMAC', hash: `SHA-${jwk.alg.slice(-3)}` };\n                    keyUsages = ['sign', 'verify'];\n                    break;\n                case 'A128CBC-HS256':\n                case 'A192CBC-HS384':\n                case 'A256CBC-HS512':\n                    throw new JOSENotSupported(`${jwk.alg} keys cannot be imported as CryptoKey instances`);\n                case 'A128GCM':\n                case 'A192GCM':\n                case 'A256GCM':\n                case 'A128GCMKW':\n                case 'A192GCMKW':\n                case 'A256GCMKW':\n                    algorithm = { name: 'AES-GCM' };\n                    keyUsages = ['encrypt', 'decrypt'];\n                    break;\n                case 'A128KW':\n                case 'A192KW':\n                case 'A256KW':\n                    algorithm = { name: 'AES-KW' };\n                    keyUsages = ['wrapKey', 'unwrapKey'];\n                    break;\n                case 'PBES2-HS256+A128KW':\n                case 'PBES2-HS384+A192KW':\n                case 'PBES2-HS512+A256KW':\n                    algorithm = { name: 'PBKDF2' };\n                    keyUsages = ['deriveBits'];\n                    break;\n                default:\n                    throw new JOSENotSupported('Invalid or unsupported JWK \"alg\" (Algorithm) Parameter value');\n            }\n            break;\n        }\n        case 'RSA': {\n            switch (jwk.alg) {\n                case 'PS256':\n                case 'PS384':\n                case 'PS512':\n                    algorithm = { name: 'RSA-PSS', hash: `SHA-${jwk.alg.slice(-3)}` };\n                    keyUsages = jwk.d ? ['sign'] : ['verify'];\n                    break;\n                case 'RS256':\n                case 'RS384':\n                case 'RS512':\n                    algorithm = { name: 'RSASSA-PKCS1-v1_5', hash: `SHA-${jwk.alg.slice(-3)}` };\n                    keyUsages = jwk.d ? ['sign'] : ['verify'];\n                    break;\n                case 'RSA-OAEP':\n                case 'RSA-OAEP-256':\n                case 'RSA-OAEP-384':\n                case 'RSA-OAEP-512':\n                    algorithm = {\n                        name: 'RSA-OAEP',\n                        hash: `SHA-${parseInt(jwk.alg.slice(-3), 10) || 1}`,\n                    };\n                    keyUsages = jwk.d ? ['decrypt', 'unwrapKey'] : ['encrypt', 'wrapKey'];\n                    break;\n                default:\n                    throw new JOSENotSupported('Invalid or unsupported JWK \"alg\" (Algorithm) Parameter value');\n            }\n            break;\n        }\n        case 'EC': {\n            switch (jwk.alg) {\n                case 'ES256':\n                    algorithm = { name: 'ECDSA', namedCurve: 'P-256' };\n                    keyUsages = jwk.d ? ['sign'] : ['verify'];\n                    break;\n                case 'ES384':\n                    algorithm = { name: 'ECDSA', namedCurve: 'P-384' };\n                    keyUsages = jwk.d ? ['sign'] : ['verify'];\n                    break;\n                case 'ES512':\n                    algorithm = { name: 'ECDSA', namedCurve: 'P-521' };\n                    keyUsages = jwk.d ? ['sign'] : ['verify'];\n                    break;\n                case 'ECDH-ES':\n                case 'ECDH-ES+A128KW':\n                case 'ECDH-ES+A192KW':\n                case 'ECDH-ES+A256KW':\n                    algorithm = { name: 'ECDH', namedCurve: jwk.crv };\n                    keyUsages = jwk.d ? ['deriveBits'] : [];\n                    break;\n                default:\n                    throw new JOSENotSupported('Invalid or unsupported JWK \"alg\" (Algorithm) Parameter value');\n            }\n            break;\n        }\n        case (isCloudflareWorkers() || isNodeJs()) && 'OKP':\n            if (jwk.alg !== 'EdDSA') {\n                throw new JOSENotSupported('Invalid or unsupported JWK \"alg\" (Algorithm) Parameter value');\n            }\n            switch (jwk.crv) {\n                case 'Ed25519':\n                    algorithm = { name: 'NODE-ED25519', namedCurve: 'NODE-ED25519' };\n                    keyUsages = jwk.d ? ['sign'] : ['verify'];\n                    break;\n                case isNodeJs() && 'Ed448':\n                    algorithm = { name: 'NODE-ED448', namedCurve: 'NODE-ED448' };\n                    keyUsages = jwk.d ? ['sign'] : ['verify'];\n                    break;\n                default:\n                    throw new JOSENotSupported('Invalid or unsupported JWK \"crv\" (Subtype of Key Pair) Parameter value');\n            }\n            break;\n        default:\n            throw new JOSENotSupported('Invalid or unsupported JWK \"kty\" (Key Type) Parameter value');\n    }\n    return { algorithm, keyUsages };\n}\nconst parse = async (jwk) => {\n    var _a, _b;\n    const { algorithm, keyUsages } = subtleMapping(jwk);\n    const rest = [\n        algorithm,\n        (_a = jwk.ext) !== null && _a !== void 0 ? _a : false,\n        (_b = jwk.key_ops) !== null && _b !== void 0 ? _b : keyUsages,\n    ];\n    if (algorithm.name === 'PBKDF2') {\n        return crypto.subtle.importKey('raw', base64url(jwk.k), ...rest);\n    }\n    const keyData = { ...jwk };\n    delete keyData.alg;\n    return crypto.subtle.importKey('jwk', keyData, ...rest);\n};\nexport default parse;\n"],"mappings":"AAAA,SAASA,mBAAT,EAA8BC,QAA9B,QAA8C,UAA9C;AACA,OAAOC,MAAP,MAAmB,gBAAnB;AACA,SAASC,gBAAT,QAAiC,mBAAjC;AACA,SAASC,MAAM,IAAIC,SAAnB,QAAoC,gBAApC;;AACA,SAASC,aAAT,CAAuBC,GAAvB,EAA4B;EACxB,IAAIC,SAAJ;EACA,IAAIC,SAAJ;;EACA,QAAQF,GAAG,CAACG,GAAZ;IACI,KAAK,KAAL;MAAY;QACR,QAAQH,GAAG,CAACI,GAAZ;UACI,KAAK,OAAL;UACA,KAAK,OAAL;UACA,KAAK,OAAL;YACIH,SAAS,GAAG;cAAEI,IAAI,EAAE,MAAR;cAAgBC,IAAI,EAAG,OAAMN,GAAG,CAACI,GAAJ,CAAQG,KAAR,CAAc,CAAC,CAAf,CAAkB;YAA/C,CAAZ;YACAL,SAAS,GAAG,CAAC,MAAD,EAAS,QAAT,CAAZ;YACA;;UACJ,KAAK,eAAL;UACA,KAAK,eAAL;UACA,KAAK,eAAL;YACI,MAAM,IAAIN,gBAAJ,CAAsB,GAAEI,GAAG,CAACI,GAAI,iDAAhC,CAAN;;UACJ,KAAK,SAAL;UACA,KAAK,SAAL;UACA,KAAK,SAAL;UACA,KAAK,WAAL;UACA,KAAK,WAAL;UACA,KAAK,WAAL;YACIH,SAAS,GAAG;cAAEI,IAAI,EAAE;YAAR,CAAZ;YACAH,SAAS,GAAG,CAAC,SAAD,EAAY,SAAZ,CAAZ;YACA;;UACJ,KAAK,QAAL;UACA,KAAK,QAAL;UACA,KAAK,QAAL;YACID,SAAS,GAAG;cAAEI,IAAI,EAAE;YAAR,CAAZ;YACAH,SAAS,GAAG,CAAC,SAAD,EAAY,WAAZ,CAAZ;YACA;;UACJ,KAAK,oBAAL;UACA,KAAK,oBAAL;UACA,KAAK,oBAAL;YACID,SAAS,GAAG;cAAEI,IAAI,EAAE;YAAR,CAAZ;YACAH,SAAS,GAAG,CAAC,YAAD,CAAZ;YACA;;UACJ;YACI,MAAM,IAAIN,gBAAJ,CAAqB,8DAArB,CAAN;QAjCR;;QAmCA;MACH;;IACD,KAAK,KAAL;MAAY;QACR,QAAQI,GAAG,CAACI,GAAZ;UACI,KAAK,OAAL;UACA,KAAK,OAAL;UACA,KAAK,OAAL;YACIH,SAAS,GAAG;cAAEI,IAAI,EAAE,SAAR;cAAmBC,IAAI,EAAG,OAAMN,GAAG,CAACI,GAAJ,CAAQG,KAAR,CAAc,CAAC,CAAf,CAAkB;YAAlD,CAAZ;YACAL,SAAS,GAAGF,GAAG,CAACQ,CAAJ,GAAQ,CAAC,MAAD,CAAR,GAAmB,CAAC,QAAD,CAA/B;YACA;;UACJ,KAAK,OAAL;UACA,KAAK,OAAL;UACA,KAAK,OAAL;YACIP,SAAS,GAAG;cAAEI,IAAI,EAAE,mBAAR;cAA6BC,IAAI,EAAG,OAAMN,GAAG,CAACI,GAAJ,CAAQG,KAAR,CAAc,CAAC,CAAf,CAAkB;YAA5D,CAAZ;YACAL,SAAS,GAAGF,GAAG,CAACQ,CAAJ,GAAQ,CAAC,MAAD,CAAR,GAAmB,CAAC,QAAD,CAA/B;YACA;;UACJ,KAAK,UAAL;UACA,KAAK,cAAL;UACA,KAAK,cAAL;UACA,KAAK,cAAL;YACIP,SAAS,GAAG;cACRI,IAAI,EAAE,UADE;cAERC,IAAI,EAAG,OAAMG,QAAQ,CAACT,GAAG,CAACI,GAAJ,CAAQG,KAAR,CAAc,CAAC,CAAf,CAAD,EAAoB,EAApB,CAAR,IAAmC,CAAE;YAF1C,CAAZ;YAIAL,SAAS,GAAGF,GAAG,CAACQ,CAAJ,GAAQ,CAAC,SAAD,EAAY,WAAZ,CAAR,GAAmC,CAAC,SAAD,EAAY,SAAZ,CAA/C;YACA;;UACJ;YACI,MAAM,IAAIZ,gBAAJ,CAAqB,8DAArB,CAAN;QAxBR;;QA0BA;MACH;;IACD,KAAK,IAAL;MAAW;QACP,QAAQI,GAAG,CAACI,GAAZ;UACI,KAAK,OAAL;YACIH,SAAS,GAAG;cAAEI,IAAI,EAAE,OAAR;cAAiBK,UAAU,EAAE;YAA7B,CAAZ;YACAR,SAAS,GAAGF,GAAG,CAACQ,CAAJ,GAAQ,CAAC,MAAD,CAAR,GAAmB,CAAC,QAAD,CAA/B;YACA;;UACJ,KAAK,OAAL;YACIP,SAAS,GAAG;cAAEI,IAAI,EAAE,OAAR;cAAiBK,UAAU,EAAE;YAA7B,CAAZ;YACAR,SAAS,GAAGF,GAAG,CAACQ,CAAJ,GAAQ,CAAC,MAAD,CAAR,GAAmB,CAAC,QAAD,CAA/B;YACA;;UACJ,KAAK,OAAL;YACIP,SAAS,GAAG;cAAEI,IAAI,EAAE,OAAR;cAAiBK,UAAU,EAAE;YAA7B,CAAZ;YACAR,SAAS,GAAGF,GAAG,CAACQ,CAAJ,GAAQ,CAAC,MAAD,CAAR,GAAmB,CAAC,QAAD,CAA/B;YACA;;UACJ,KAAK,SAAL;UACA,KAAK,gBAAL;UACA,KAAK,gBAAL;UACA,KAAK,gBAAL;YACIP,SAAS,GAAG;cAAEI,IAAI,EAAE,MAAR;cAAgBK,UAAU,EAAEV,GAAG,CAACW;YAAhC,CAAZ;YACAT,SAAS,GAAGF,GAAG,CAACQ,CAAJ,GAAQ,CAAC,YAAD,CAAR,GAAyB,EAArC;YACA;;UACJ;YACI,MAAM,IAAIZ,gBAAJ,CAAqB,8DAArB,CAAN;QArBR;;QAuBA;MACH;;IACD,KAAK,CAACH,mBAAmB,MAAMC,QAAQ,EAAlC,KAAyC,KAA9C;MACI,IAAIM,GAAG,CAACI,GAAJ,KAAY,OAAhB,EAAyB;QACrB,MAAM,IAAIR,gBAAJ,CAAqB,8DAArB,CAAN;MACH;;MACD,QAAQI,GAAG,CAACW,GAAZ;QACI,KAAK,SAAL;UACIV,SAAS,GAAG;YAAEI,IAAI,EAAE,cAAR;YAAwBK,UAAU,EAAE;UAApC,CAAZ;UACAR,SAAS,GAAGF,GAAG,CAACQ,CAAJ,GAAQ,CAAC,MAAD,CAAR,GAAmB,CAAC,QAAD,CAA/B;UACA;;QACJ,KAAKd,QAAQ,MAAM,OAAnB;UACIO,SAAS,GAAG;YAAEI,IAAI,EAAE,YAAR;YAAsBK,UAAU,EAAE;UAAlC,CAAZ;UACAR,SAAS,GAAGF,GAAG,CAACQ,CAAJ,GAAQ,CAAC,MAAD,CAAR,GAAmB,CAAC,QAAD,CAA/B;UACA;;QACJ;UACI,MAAM,IAAIZ,gBAAJ,CAAqB,wEAArB,CAAN;MAVR;;MAYA;;IACJ;MACI,MAAM,IAAIA,gBAAJ,CAAqB,6DAArB,CAAN;EAhHR;;EAkHA,OAAO;IAAEK,SAAF;IAAaC;EAAb,CAAP;AACH;;AACD,MAAMU,KAAK,GAAG,MAAOZ,GAAP,IAAe;EACzB,IAAIa,EAAJ,EAAQC,EAAR;;EACA,MAAM;IAAEb,SAAF;IAAaC;EAAb,IAA2BH,aAAa,CAACC,GAAD,CAA9C;EACA,MAAMe,IAAI,GAAG,CACTd,SADS,EAET,CAACY,EAAE,GAAGb,GAAG,CAACgB,GAAV,MAAmB,IAAnB,IAA2BH,EAAE,KAAK,KAAK,CAAvC,GAA2CA,EAA3C,GAAgD,KAFvC,EAGT,CAACC,EAAE,GAAGd,GAAG,CAACiB,OAAV,MAAuB,IAAvB,IAA+BH,EAAE,KAAK,KAAK,CAA3C,GAA+CA,EAA/C,GAAoDZ,SAH3C,CAAb;;EAKA,IAAID,SAAS,CAACI,IAAV,KAAmB,QAAvB,EAAiC;IAC7B,OAAOV,MAAM,CAACuB,MAAP,CAAcC,SAAd,CAAwB,KAAxB,EAA+BrB,SAAS,CAACE,GAAG,CAACoB,CAAL,CAAxC,EAAiD,GAAGL,IAApD,CAAP;EACH;;EACD,MAAMM,OAAO,GAAG,EAAE,GAAGrB;EAAL,CAAhB;EACA,OAAOqB,OAAO,CAACjB,GAAf;EACA,OAAOT,MAAM,CAACuB,MAAP,CAAcC,SAAd,CAAwB,KAAxB,EAA+BE,OAA/B,EAAwC,GAAGN,IAA3C,CAAP;AACH,CAdD;;AAeA,eAAeH,KAAf"},"metadata":{},"sourceType":"module"}